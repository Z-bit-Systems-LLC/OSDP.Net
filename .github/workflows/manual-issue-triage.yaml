name: Claude Issue Triage
on:
  workflow_dispatch:
    inputs:
      issue_number:
        description: 'Issue number to triage'
        required: true
        type: number

jobs:
  triage:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      issues: write
      pull-requests: write
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      
      - uses: anthropics/claude-code-action@v1
        with:
          anthropic_api_key: ${{ secrets.ANTHROPIC_API_KEY }}
          github_token: ${{ secrets.GITHUB_TOKEN }}
          settings: |
            {
              "permissions": {
                "allow": [
                  "mcp__github__*",
                  "Read",
                  "Grep",
                  "WebSearch"
                ]
              }
            }
          prompt: |
            Analyze issue #${{ inputs.issue_number }} for this C# OSDP library and:
            1. Read the issue details
            2. Categorize (bug/feature/question/enhancement)
            3. Search the codebase for relevant C# files
            4. Assess complexity and priority
            5. Post a comment with your analysis
